<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<meta name="theme-color" content="<%= locals.seo.themeColor %>">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Hook0">
<meta name="format-detection" content="telephone=no">

<!-- SEO Meta Tags -->
<% if (locals.pageDescription) { %>
<meta name="description" content="<%= locals.pageDescription %>">
<% } else { %>
<meta name="description" content="<%= locals.seo.defaultDescription %>">
<% } %>

<!-- Canonical URL -->
<% if (locals.pageCanonical) { %>
<link rel="canonical" href="<%= locals.seo.siteUrl %><%= locals.pageCanonical %>">
<% } %>

<!-- Open Graph / Facebook -->
<meta property="og:type" content="<%= locals.pageType || 'website' %>">
<meta property="og:site_name" content="<%= locals.seo.siteName %>">
<% if (locals.pageCanonical) { %>
<meta property="og:url" content="<%= locals.seo.siteUrl %><%= locals.pageCanonical %>">
<% } %>
<% if (locals.pageTitle) { %>
<meta property="og:title" content="<%= locals.pageTitle %>">
<% } else { %>
<meta property="og:title" content="<%= locals.seo.defaultTitle %>">
<% } %>
<% if (locals.pageDescription) { %>
<meta property="og:description" content="<%= locals.pageDescription %>">
<% } else { %>
<meta property="og:description" content="<%= locals.seo.defaultDescription %>">
<% } %>
<% if (locals.pageImage) { %>
<meta property="og:image" content="<%= locals.seo.siteUrl %><%= locals.pageImage %>">
<% } else { %>
<meta property="og:image" content="<%= locals.seo.siteUrl %><%= locals.seo.defaultImage %>">
<% } %>
<meta property="og:locale" content="<%= locals.seo.locale %>">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="<%= locals.seo.twitterHandle %>">
<meta name="twitter:creator" content="<%= locals.seo.twitterHandle %>">
<% if (locals.pageTitle) { %>
<meta name="twitter:title" content="<%= locals.pageTitle %>">
<% } else { %>
<meta name="twitter:title" content="<%= locals.seo.defaultTitle %>">
<% } %>
<% if (locals.pageDescription) { %>
<meta name="twitter:description" content="<%= locals.pageDescription %>">
<% } else { %>
<meta name="twitter:description" content="<%= locals.seo.defaultDescription %>">
<% } %>
<% if (locals.pageImage) { %>
<meta name="twitter:image" content="<%= locals.seo.siteUrl %><%= locals.pageImage %>">
<% } else { %>
<meta name="twitter:image" content="<%= locals.seo.siteUrl %><%= locals.seo.defaultImage %>">
<% } %>

<!-- Preconnect to Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<!-- Preload critical font -->
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"></noscript>

<!-- DNS Prefetch for external resources -->
<link rel="dns-prefetch" href="https://api.producthunt.com">
<link rel="dns-prefetch" href="https://ghbtns.com">

<!-- Stylesheet -->
<link rel='stylesheet' href='./style.scss'/>

<!-- Favicon and PWA -->
<link rel="icon" type="image/png" href="./mediakit/logo/110x110-white.png">
<link rel="icon" type="image/png" sizes="32x32" href="./mediakit/logo/32x32-white.png">
<link rel="icon" type="image/png" sizes="16x16" href="./mediakit/logo/16x16-white.png">
<link rel="apple-touch-icon" sizes="180x180" href="./mediakit/logo/256x256-white.png">
<%# PWA Manifest - added via JS to avoid Parcel resolution %>

<% if (process.env.CRISP_WEBSITE_ID) { %>
<!-- Crisp -->
<script type="text/javascript">
    window.$crisp=[];
    window.CRISP_WEBSITE_ID="<%= process.env.CRISP_WEBSITE_ID %>";
    (function(){d=document;s=d.createElement("script");s.src="https://client.crisp.chat/l.js";s.async=1;d.getElementsByTagName("head")[0].appendChild(s);})();
</script>
<% } %>

<% if (process.env.MATOMO_URL && process.env.MATOMO_SITE_ID) { %>
<!-- Cookie Consent Banner -->
<style>
.cookie-banner{position:fixed;bottom:0;left:0;right:0;z-index:9999;padding:1rem;background:#111118;border-top:1px solid rgba(255,255,255,0.1);transform:translateY(100%);transition:transform 0.3s ease-out}
.cookie-banner.is-visible{transform:translateY(0)}
.cookie-banner__inner{max-width:72rem;margin:0 auto;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:1rem}
.cookie-banner__text{flex:1;min-width:280px;color:#9ca3af;font-size:0.875rem}
.cookie-banner__text a{color:#818cf8;text-decoration:underline}
.cookie-banner__buttons{display:flex;align-items:center;gap:1rem}
.cookie-banner__btn--decline{background:none;border:none;color:#6b7280;font-size:0.875rem;cursor:pointer;text-decoration:underline;padding:0.5rem}
.cookie-banner__btn--decline:hover{color:#9ca3af}
.cookie-banner__btn--accept{background:#22c55e;color:#fff;border:none;padding:0.75rem 1.5rem;border-radius:0.75rem;font-weight:600;font-size:0.875rem;cursor:pointer;box-shadow:0 0 20px rgba(34,197,94,0.4);transition:all 0.2s}
.cookie-banner__btn--accept:hover{background:#16a34a;box-shadow:0 0 30px rgba(34,197,94,0.6);transform:scale(1.02)}
</style>
<div id="cookie-consent-banner" class="cookie-banner" role="dialog" aria-label="Cookie consent">
    <div class="cookie-banner__inner">
        <div class="cookie-banner__text">We use cookies to analyze site usage and improve your experience. <a href="./privacy-policy">Privacy Policy</a></div>
        <div class="cookie-banner__buttons">
            <button type="button" class="cookie-banner__btn--decline" onclick="window.hook0Consent.deny()">Decline</button>
            <button type="button" class="cookie-banner__btn--accept" onclick="window.hook0Consent.accept()">Accept</button>
        </div>
    </div>
</div>
<!-- Matomo with Consent -->
<script>
(function(){
    var KEY='hook0_cookie_consent',_paq=window._paq=window._paq||[];
    function getConsent(){try{return localStorage.getItem(KEY)}catch(e){return null}}
    function setConsent(v){try{localStorage.setItem(KEY,v)}catch(e){}}
    function removeConsent(){try{localStorage.removeItem(KEY)}catch(e){}}
    _paq.push(['requireConsent']);
    var consent=getConsent();
    if(consent==='granted')_paq.push(['setConsentGiven']);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function(){var u="<%= process.env.MATOMO_URL %>";_paq.push(['setTrackerUrl',u+'piwik.php']);_paq.push(['setSiteId','<%= process.env.MATOMO_SITE_ID %>']);var d=document,g=d.createElement('script'),s=d.getElementsByTagName('script')[0];g.async=true;g.src=u+'piwik.js';s.parentNode.insertBefore(g,s)})();
    window.trackEvent=function(c,a,n,v){try{if(window._paq)window._paq.push(['trackEvent',c,a,n,v])}catch(e){}};
    function show(){var b=document.getElementById('cookie-consent-banner');if(b)b.classList.add('is-visible')}
    function hide(){var b=document.getElementById('cookie-consent-banner');if(b)b.classList.remove('is-visible')}
    window.hook0Consent={
        accept:function(){setConsent('granted');window._paq.push(['setConsentGiven']);hide()},
        deny:function(){setConsent('denied');window._paq.push(['forgetConsentGiven']);hide()},
        reset:function(){removeConsent();window._paq.push(['forgetConsentGiven']);show()},
        getStatus:function(){return getConsent()}
    };
    document.addEventListener('DOMContentLoaded',function(){
        if(!consent)show();
        // Goal 1: Registration Click - tracked via inline onclick handlers
        // Goal 2: Login Click - Event Name exact "Login"
        document.querySelectorAll('a[href*="app.hook0.com/login"]').forEach(function(el){
            el.addEventListener('click',function(){trackEvent('CTA','Click','Login')});
        });
        // Goal 3: Contact Support - Event Name exact "Contact Support"
        document.querySelectorAll('a[href*="mailto:support@hook0.com"], a[href*="crisp.chat"]').forEach(function(el){
            el.addEventListener('click',function(){trackEvent('CTA','Click','Contact Support')});
        });
        // Goal 4: Search Result Click - Event Name exact "Search Result Click"
        document.querySelectorAll('a[href*="documentation.hook0.com"]').forEach(function(el){
            el.addEventListener('click',function(){trackEvent('Documentation','Click','Search Result Click')});
        });
        // Goal 5: Full Page Read - Event Name exact "100%" (triggers at 90% scroll depth)
        var scrollTracked=false;
        window.addEventListener('scroll',function(){
            if(scrollTracked)return;
            var scrollTop=window.scrollY||document.documentElement.scrollTop;
            var docHeight=document.documentElement.scrollHeight-window.innerHeight;
            if(docHeight>0&&(scrollTop/docHeight)>=0.9){
                scrollTracked=true;
                trackEvent('Scroll','Depth','100%');
            }
        },{passive:true});
    });
})();
</script>
<!-- End Matomo Code -->
<% } %>

<!-- Structured Data -->
<% if (locals.pageSchema) { %>
<script type="application/ld+json">
<%- JSON.stringify(locals.pageSchema, null, 2) %>
</script>
<% } else { %>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Hook0",
  "url": "<%= locals.seo.siteUrl %>",
  "logo": "<%= locals.seo.siteUrl %>/mediakit/logo/110x110-white.png",
  "description": "<%= locals.seo.defaultDescription %>",
  "foundingDate": "2021",
  "founders": [
    {
      "@type": "Person",
      "name": "Francois-Guillaume Ribreau"
    },
    {
      "@type": "Person",
      "name": "David Sferruzza"
    }
  ],
  "sameAs": [
    "<%= locals.social.twitter.href %>",
    "<%= locals.social.github.href %>",
    "<%= locals.social.linkedin.href %>",
    "<%= locals.social.youtube.href %>",
    "<%= locals.social.discord.href %>"
  ],
  "contactPoint": {
    "@type": "ContactPoint",
    "email": "support@hook0.com",
    "contactType": "customer service"
  }
}
</script>
<% } %>

<!-- PWA: Service Worker & Manifest (added via JS to avoid Parcel resolution) -->
<script>
(function() {
  // Add manifest link dynamically
  var manifestLink = document.createElement('link');
  manifestLink.rel = 'manifest';
  manifestLink.href = ['', 'manifest.json'].join('/');
  document.head.appendChild(manifestLink);

  // Register Service Worker (using array join to avoid Parcel static analysis)
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
      var swPath = ['', 'sw.js'].join('/');
      navigator.serviceWorker.register(swPath)
        .then(function(registration) {
          console.log('SW registered: ', registration.scope);
        })
        .catch(function(error) {
          console.log('SW registration failed: ', error);
        });
    });
  }
})();
</script>

<!-- Scroll Animation Script -->
<script defer>
document.addEventListener('DOMContentLoaded', function() {
    // Intersection Observer for scroll-triggered animations
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(function(entry) {
            if (entry.isIntersecting) {
                entry.target.classList.add('is-visible');
                observer.unobserve(entry.target);
            }
        });
    }, observerOptions);

    document.querySelectorAll('.animate-on-scroll').forEach(function(el) {
        observer.observe(el);
    });

    // Header scroll effect
    const header = document.getElementById('main-header');
    if (header) {
        var lastScroll = 0;
        window.addEventListener('scroll', function() {
            var currentScroll = window.pageYOffset;
            if (currentScroll > 50) {
                header.classList.add('header-scrolled');
            } else {
                header.classList.remove('header-scrolled');
            }
            lastScroll = currentScroll;
        }, { passive: true });
    }

    // Card glow effect (mouse tracking)
    document.querySelectorAll('.card--glow').forEach(function(card) {
        card.addEventListener('mousemove', function(e) {
            var rect = card.getBoundingClientRect();
            var x = e.clientX - rect.left;
            var y = e.clientY - rect.top;
            card.style.setProperty('--mouse-x', x + 'px');
            card.style.setProperty('--mouse-y', y + 'px');
        });
    });
});
</script>
